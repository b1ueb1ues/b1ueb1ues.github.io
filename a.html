<body>

尖刺重锤计算器<br/>
=============
<br/><br/>


暴击率:<br/>
<input onchange="click_1()" ="text" id="t1" value="80" size="3"></input>%

<br/><br/>

暴击伤害(点锤子之前):<br/>
<input onchange="click_1()" type="text" id="t2" value="200" size="3"></input>%

<br/><br/>


尖刺能力石lv:<br/>
<input onchange="click_1()" type="radio" id="r_0" name="stone" value="0" checked />
<label for="r_0">0</label>
<br/>
<input onchange="click_1()" type="radio" id="r_1" name="stone" value="7.5" />
<label for="r_1">1</label>
<br/>
<input onchange="click_1()" type="radio" id="r_2" name="stone" value="9.4" />
<label for="r_2">2</label>
<br/>
<input onchange="click_1()" type="radio" id="r_3" name="stone" value="13.2" />
<label for="r_3">3</label>
<br/>
<input onchange="click_1()" type="radio" id="r_4" name="stone" value="15" />
<label for="r_4">4</label>

<br/><br/>

<input onchange="click_1()" type="checkbox" id="c1">强击套</input>
<input onchange="click_1()" type="checkbox" id="c2">枪术buff</input>

<br/><br/>


<div id="out"> ___ </div>

</body>

<script>
    function calc(cc, cd, mcd) {
        if (cc > 1) {
            cc = 1;
        }
        let cb = cd * (1 + mcd) - 1;
        return cc*cb + 1
    }

    function click_1() {
        console.log("> <.");
        let cc = 0.01 * document.getElementById("t1").value;
        let cd = 0.01 * document.getElementById("t2").value;
        let mcd12 = document.getElementById("c1").checked;
        let mcd8 = document.getElementById("c2").checked;
        let stone = 0.01 * document.querySelector('input[name="stone"]:checked').value;
        
        let mcd = 0;
        if (mcd12 == true) {
            mcd += 0.12
        }
        if (mcd8 == true) {
            mcd += 0.08
        }
        
        let dmg_base = calc(cc, cd, mcd);
        let dmg_keen = calc(cc, cd+0.44, mcd) * 0.98;
        let dmg_keen_stone = calc(cc, cd+0.44+stone, mcd) * 0.98;
        
        console.log("no keen:", dmg_base);
        console.log("keen:", dmg_keen);
        console.log("keen+stone:", dmg_keen_stone);

        let kbw_boost = (dmg_keen_stone/dmg_base-1)*100

        let base_boost = (dmg_keen/dmg_base-1)*100;
        let stone_additive = kbw_boost - base_boost;

        let stone_boost = (dmg_keen_stone/dmg_keen-1)*100
       

        let out = document.getElementById("out");
        out.innerText = "- result ----------------------------------\n";
        out.innerText += "尖刺总提升(等效增伤): "+kbw_boost.toFixed(2)+"%\n";
        out.innerText += "\n";

        out.innerText += "- verbose ----------------------------------\n";
        out.innerText += "等效增伤刻印: "+base_boost.toFixed(2)+"%+" + stone_additive.toFixed(2) + "%\n";
        out.innerText += "能力石提升(最终乘算): "+stone_boost.toFixed(2)+"%\n";
    }
    
    click_1();
</script>
